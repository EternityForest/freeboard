!function(){var e=0;freeboard.addStyle(".datagrid","border: 2px solid #3d3d3d;background-color: #222;margin: 10px;"),freeboard.addStyle(".datagrid-label","margin-left: 10px; margin-top: 10px; text-transform: capitalize;"),freeboard.addStyle(".myui-datagrid-handle","width: 1.5em !important; height: 1.5em !important; border-radius: 50%; top: -.4em !important; margin-left:-1.0em !important;"),freeboard.addStyle(".ui-datagrid-range","background: #F90;"),freeboard.loadWidgetPlugin({type_name:"jsGrid",display_name:"jsGrid Data grid View Plugin",description:"Database grid view.  Requires a JSGrid controller as it's data source",fill_size:!0,settings:[{name:"title",display_name:"Title",type:"text",default_value:""},{name:"backend",display_name:"Data backend(JS controller)",type:"calculated",default_value:""},{name:"columns",display_name:"Display Columns",type:"calculated",default_value:'=[\n{ name: "Name", type: "text", width: 150},\n{name: "Country", type: "text"}]'},{name:"selectionTarget",display_name:"Data target when selection changes. ",description:"Value pushed will be a value, timestamp pair. Value will be the entire selected record object",type:"target"}],newInstance:function(e,n){n(new t(e))}});var t=function(t){var n=this;n.currentSettings=t;var a="datagrid-"+e++,i=$('<div class="datagrid-widget datagrid-label" id="__'+a+'"></div>'),r=$('<h2 class="section-title datagrid-label"></h2>'),l=$("<div>",{id:a}).css("width","90%"),o="#"+a,d="#value-"+a;n.refreshGrid=function(){$(o).jsGrid("destroy"),$(o).jsGrid({width:"100%",height:"400px",inserting:!0,editing:!0,sorting:!0,paging:!0,data:[{Name:"Otto Clay",Age:25,Country:1,Address:"Ap #897-1459 Quam Avenue",Married:!1}],fields:n.currentSettings.columns})},r.html(n.currentSettings.title),n.value=n.currentSettings.value||0;n.render=function(e){$(e).append(i),r.appendTo(i),l.appendTo(i),n.refreshGrid(),$(d).html(n.value+n.currentSettings.unit),$(o).removeClass("ui-widget-content")},n.getHeight=function(){return 2},n.onSettingsChanged=function(e){n.currentSettings=e,r.html(_.isUndefined(e.title)?"":e.title),n.currentSettings.unit=n.currentSettings.unit||"",$(o).attr("pattern",e.pattern),$(o).attr("placeholder",e.placeholder),$(o).attr("tooltip",e.placeholder)},n.onCalculatedValueChanged=function(e,t){"columns"==e&&n.refreshGrid()},n.onDispose=function(){$(o).jsGrid("destroy")}}}();var htmlWidget=function(e){var t=$('<div class="html-widget" style="overflow:auto;height:100%;width:100%;"></div>'),n=e;this.render=function(n){$(n).append(t),t.html(e.html)},this.onSettingsChanged=function(a){n=a,t.html(e.html)},this.onCalculatedValueChanged=function(e,n){"html"==e&&t.html(n)},this.onDispose=function(){},this.getHeight=function(){return Number(n.height)},this.onSettingsChanged(e)};function uuidv4(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16))}freeboard.loadWidgetPlugin({type_name:"html-template",display_name:"Rich Text Content",fill_size:!0,settings:[{name:"html",display_name:"HTML",type:"html-wysywig",description:"HTML template.  You can paste images here, they are stored in the freeboard config itself as base64."},{name:"height",display_name:"Height Blocks",type:"number",default_value:4,description:"A height block is around 60 pixels"}],newInstance:function(e,t){t(new htmlWidget(e))}}),function(){var e=0;freeboard.addStyle(".button","border: 2px solid #3d3d3d;background-color: #222;margin: 10px;"),freeboard.addStyle(".button-label","margin-left: 10px; margin-top: 10px; text-transform: capitalize;"),freeboard.addStyle(".myui-button-handle","width: 1.5em !important; height: 1.5em !important; border-radius: 50%; top: -.4em !important; margin-left:-1.0em !important;"),freeboard.addStyle(".ui-button-range","background: #F90;"),freeboard.loadWidgetPlugin({type_name:"button_plugin",display_name:"Button",description:"DataTarget compatible button that can run JS code when clicked",fill_size:!0,settings:[{name:"html",display_name:"Button Contents",type:"calculated",default_value:"<i>Button</i>"},{name:"tooltip",display_name:"Tooltip hint",type:"text",default_value:""},{name:"value",display_name:"Value",description:"This value gets pushed to the target when clicked.  If empty, a simple counter is used.  It recalculated every click.",type:"calculated"},{name:"target",display_name:"Data target when clicked",description:'"value" pushed will be a value,timestamp pair. Value defaults to a click counter',type:"target"}],newInstance:function(e,n){n(new t(e))}});var t=function(t){var n=this;n.currentSettings=t;var a="button-"+e++,i=$('<div class="button-widget button-label" id="__'+a+'"></div>'),r=$("<button/>",{type:"text",pattern:t.pattern,id:a}).html(t.html).css("width","95%"),l="#"+a;n.clickCount=0,n.value=t.value||"",n.render=function(e){$(e).append(i),r.appendTo(i),$(l).attr("title",n.currentSettings.tooltip),$(l).on("click",async function(e){var a=n.clickCount;$(l).attr("disabled",!0).html(t.html+"(waiting)"),await n.processCalculatedSetting("value"),_.isUndefined(n.currentSettings.value)||(a=n.value),_.isUndefined(n.currentSettings.target)||await n.dataTargets.target([a,Date.now()/1e3]),n.clickCount+=1,$(l).attr("disabled",!1).html(t.html)}),$(l).removeClass("ui-widget-content")},n.getHeight=function(){return"big"==n.currentSettings.size?2:1},n.onSettingsChanged=function(e){n.currentSettings=e,n.currentSettings.unit=n.currentSettings.unit||"",$(l).attr("tooltip",e.placeholder)},n.onCalculatedValueChanged=function(e,t){"html"==e&&$(l).html(t),"value"==e&&(n.value=t)},n.onDispose=function(){}}}(),function(){freeboard.loadDatasourcePlugin({type_name:"document_database_plugin",display_name:"In-browser database",description:"DB for storing JSON records.",settings:[{name:"data",display_name:"Default Data(as JSON or JS expression)",type:"text",default_value:"={}",options:function(){return{"={key: 'value'}":""}},description:"Must be a valid JS =expression that returns an object. Whatever it returns will be the default data.",required:!0}],newInstance:function(t,n,a){n(new e(t,a))}});var e=async function(e,t){var n=this;n.makeDB=async function(){n.db=await nSQL().createDatabase({id:"my-db",mode:"TEMP",tables:[{name:"records",model:{".uuid:uuid":{pk:!0}}}]})},await n.makeDB();n.database=new alasql.Database,n.database.exec("CREATE TABLE one (two INT)"),n.handler={set:function(e,t,n){throw new Error("You can't set anything here, all DB properties are async.")}},n.data={query:function(e){nSQL().useDatabase("my_db");var t=nSQL("records").query("select");for(i in e)t=t.where([i,"=",e[i]]);return t.exec()},set:function(e){var t={};t.assign(e),t[".time"]=t[".time"]|1e3*Date.now(),t[".arrival"]=t[".arrival"]|1e3*Date.now(),t[".name"]=t[".name"]|String(1e3*Date.now()),nSQL().useDatabase("my_db"),nSQL("records").query("upsert",t).exec()}},n.proxy=new Proxy(n.data,n.handler),n.onSettingsChanged=function(e){e,n.data=freeboard.eval(e.data),t(n.proxy)},n.updateNow=function(){var e;e=n.proxy,t(e)},n.onDispose=function(){}}}(),function(){freeboard.loadDatasourcePlugin({type_name:"JSON",settings:[{name:"url",display_name:"URL",type:"text"},{name:"use_thingproxy",display_name:"Try thingproxy",description:'A direct JSON connection will be tried first, if that fails, a JSONP connection will be tried. If that fails, you can use thingproxy, which can solve many connection problems to APIs. <a href="https://github.com/Freeboard/thingproxy" target="_blank">More information</a>.',type:"boolean",default_value:!0},{name:"refresh",display_name:"Refresh Every",type:"number",suffix:"seconds",default_value:5},{name:"method",display_name:"Method",type:"option",options:[{name:"GET",value:"GET"},{name:"POST",value:"POST"},{name:"PUT",value:"PUT"},{name:"DELETE",value:"DELETE"}]},{name:"body",display_name:"Body",type:"text",description:"The body of the request. Normally only used if method is POST"},{name:"headers",display_name:"Headers",type:"array",settings:[{name:"name",display_name:"Name",type:"text"},{name:"value",display_name:"Value",type:"text"}]}],newInstance:function(e,t,n){t(new function(e,t){var n=this,a=null,i=e,r=0,l=!1;function o(e){a&&clearInterval(a),a=setInterval(function(){n.updateNow()},e)}o(1e3*i.refresh),this.updateNow=function(){if(!(r>1&&!i.use_thingproxy||r>2)){var e=i.url;2==r&&i.use_thingproxy&&(e=("https:"==location.protocol?"https:":"http:")+"//thingproxy.freeboard.io/fetch/"+encodeURI(i.url));var a=i.body;if(a)try{a=JSON.parse(a)}catch(e){}$.ajax({url:e,dataType:1==r?"JSONP":"JSON",type:i.method||"GET",data:a,beforeSend:function(e){try{_.each(i.headers,function(t){var n=t.name,a=t.value;_.isUndefined(n)||_.isUndefined(a)||e.setRequestHeader(n,a)})}catch(e){}},success:function(e){l=!0,t(e)},error:function(e,t,a){l||(r++,n.updateNow())}})}},this.onDispose=function(){clearInterval(a),a=null},this.onSettingsChanged=function(e){l=!1,r=0,o(1e3*(i=e).refresh),n.updateNow()}}(e,n))}});freeboard.loadDatasourcePlugin({type_name:"openweathermap",display_name:"Open Weather Map API",settings:[{name:"api_key",display_name:"API Key",type:"text",description:"Your personal API Key from Open Weather Map"},{name:"location",display_name:"Location",type:"text",description:"Example: London, UK"},{name:"units",display_name:"Units",type:"option",default:"imperial",options:[{name:"Imperial",value:"imperial"},{name:"Metric",value:"metric"}]},{name:"refresh",display_name:"Refresh Every",type:"number",suffix:"seconds",default_value:5}],newInstance:function(e,t,n){t(new function(e,t){var n=this,a=null,i=e;function r(e){a&&clearInterval(a),a=setInterval(function(){n.updateNow()},e)}r(1e3*i.refresh),this.updateNow=function(){$.ajax({url:"http://api.openweathermap.org/data/2.5/weather?APPID="+i.api_key+"&q="+encodeURIComponent(i.location)+"&units="+i.units,dataType:"JSONP",success:function(e){var n,a={place_name:e.name,sunrise:new Date(1e3*e.sys.sunrise).toLocaleTimeString(),sunset:new Date(1e3*e.sys.sunset).toLocaleTimeString(),conditions:(n=e.weather[0].description,n.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})),current_temp:e.main.temp,high_temp:e.main.temp_max,low_temp:e.main.temp_min,pressure:e.main.pressure,humidity:e.main.humidity,wind_speed:e.wind.speed,wind_direction:e.wind.deg};t(a)},error:function(e,t,n){}})},this.onDispose=function(){clearInterval(a),a=null},this.onSettingsChanged=function(e){i=e,n.updateNow(),r(1e3*i.refresh)}}(e,n))}});freeboard.loadDatasourcePlugin({type_name:"dweet_io",display_name:"Dweet.io",external_scripts:["http://dweet.io/client/dweet.io.min.js"],settings:[{name:"thing_id",display_name:"Thing Name",description:"Example: salty-dog-1",type:"text"}],newInstance:function(e,t,n){t(new function(e,t){var n=e;function a(e){t(e)}this.updateNow=function(){dweetio.get_latest_dweet_for(n.thing_id,function(e,t){e||a(t[0].content)})},this.onDispose=function(){},this.onSettingsChanged=function(e){dweetio.stop_listening_for(n.thing_id),n=e,dweetio.listen_for(n.thing_id,function(e){a(e.content)})},this.onSettingsChanged(e)}(e,n))}});freeboard.loadDatasourcePlugin({type_name:"playback",display_name:"Playback",settings:[{name:"datafile",display_name:"Data File URL",type:"text",description:"A link to a JSON array of data."},{name:"is_jsonp",display_name:"Is JSONP",type:"boolean"},{name:"loop",display_name:"Loop",type:"boolean",description:"Rewind and loop when finished"},{name:"refresh",display_name:"Refresh Every",type:"number",suffix:"seconds",default_value:5}],newInstance:function(e,t,n){t(new function(e,t){var n,a=this,i=e,r=[],l=0;function o(){r.length>0?(l<r.length&&(t(r[l]),l++),l>=r.length&&i.loop&&(l=0),l<r.length&&(n=setTimeout(o,1e3*i.refresh))):t({})}function d(){r=[],l=0,n&&(clearTimeout(n),n=null)}this.updateNow=function(){d(),$.ajax({url:i.datafile,dataType:i.is_jsonp?"JSONP":"JSON",success:function(e){r=_.isArray(e)?e:[],l=0,o()},error:function(e,t,n){}})},this.onDispose=function(){d()},this.onSettingsChanged=function(e){i=e,a.updateNow()}}(e,n))}});freeboard.loadDatasourcePlugin({type_name:"clock",display_name:"Clock",settings:[{name:"refresh",display_name:"Refresh Every",type:"number",suffix:"seconds",default_value:1},{name:"strftime",display_name:"Strftime String for custom_value",type:"text",suffix:"seconds",default_value:"%I:%M:%S %p %b %d %Y"}],newInstance:function(e,t,n){t(new function(e,t){var n,a=this,i=e;function r(){n&&(clearTimeout(n),n=null)}function l(){r(),n=setInterval(a.updateNow,1e3*i.refresh)}this.updateNow=function(){var e=new Date,n="";i.strftime&&(n=strftime(i.strftime,e));var a={numeric_value:e.getTime(),custom_value:n,full_string_value:e.toLocaleString(),date_string_value:e.toLocaleDateString(),time_string_value:e.toLocaleTimeString(),date_object:e};t(a)},this.onDispose=function(){r()},this.onSettingsChanged=function(e){i=e,l()},l()}(e,n))}}),freeboard.loadDatasourcePlugin({type_name:"meshblu",display_name:"Octoblu",description:"app.octoblu.com",external_scripts:["http://meshblu.octoblu.com/js/meshblu.js"],settings:[{name:"uuid",display_name:"UUID",type:"text",default_value:"device uuid",description:"your device UUID",required:!0},{name:"token",display_name:"Token",type:"text",default_value:"device token",description:"your device TOKEN",required:!0},{name:"server",display_name:"Server",type:"text",default_value:"meshblu.octoblu.com",description:"your server",required:!0},{name:"port",display_name:"Port",type:"number",default_value:80,description:"server port",required:!0}],newInstance:function(t,n,a){n(new e(t,a))}});var e=function(e,t){var n=e;this.onSettingsChanged=function(e){n=e},this.updateNow=function(){var e;(e=skynet.createConnection({uuid:n.uuid,token:n.token,server:n.server,port:n.port})).on("ready",function(n){e.on("message",function(e){t(e)})})},this.onDispose=function(){}}}(),function(){var e=100,t=["#FF9900","#FFFFFF","#B3B4B4","#6B6B6B","#28DE28","#13F7F9","#E6EE18","#C41204","#CA3CB8","#0B1CFB"];function n(n,a,i){var r=$(n).data().values,l=$(n).data().valueMin,o=$(n).data().valueMax;r||(r=[],l=void 0,o=void 0);var d=function(t,n){r[n]||(r[n]=[]),r[n].length>=e&&r[n].shift(),r[n].push(Number(t)),(void 0===l||t<l)&&(l=t),(void 0===o||t>o)&&(o=t)};_.isArray(a)?_.each(a,d):d(a,0),$(n).data().values=r,$(n).data().valueMin=l,$(n).data().valueMax=o;var s='<span style="color: {{color}}">&#9679;</span> {{y}}',u=!1;_.each(r,function(e,a){$(n).sparkline(e,{type:"line",composite:u,height:"100%",width:"100%",fillColor:!1,lineColor:t[a%t.length],lineWidth:2,spotRadius:3,spotColor:!1,minSpotColor:"#78AB49",maxSpotColor:"#78AB49",highlightSpotColor:"#9D3926",highlightLineColor:"#9D3926",chartRangeMin:l,chartRangeMax:o,tooltipFormat:i&&i[a]?s+" ("+i[a]+")":s}),u=!0})}var a=freeboard.getStyleString("values");freeboard.addStyle(".widget-big-text",a+"font-size:75px;"),freeboard.addStyle(".tw-display","width: 100%; height:100%; display:table; table-layout:fixed;"),freeboard.addStyle(".tw-tr","display:table-row;"),freeboard.addStyle(".tw-tg","display:table-row-group;"),freeboard.addStyle(".tw-tc","display:table-caption;"),freeboard.addStyle(".tw-td","display:table-cell;"),freeboard.addStyle(".tw-value",a+"overflow: hidden;display: inline-block;text-overflow: ellipsis;"),freeboard.addStyle(".tw-unit","display: inline-block;padding-left: 10px;padding-bottom: 1.1em;vertical-align: bottom;"),freeboard.addStyle(".tw-value-wrapper","position: relative;vertical-align: middle;height:100%;"),freeboard.addStyle(".tw-sparkline","height:20px;");var i=function(e){var t=e,a=$('<div class="tw-display"></div>'),i=$('<h2 class="section-title tw-title tw-td"></h2>'),r=$('<div class="tw-value"></div>'),l=$('<div class="tw-unit"></div>'),o=$('<div class="tw-sparkline tw-td"></div>');function d(){_.isUndefined(t.units)||""==t.units?r.css("max-width","100%"):r.css("max-width",a.innerWidth()-l.outerWidth(!0)+"px")}this.render=function(e){$(e).empty(),$(a).append($('<div class="tw-tr"></div>').append(i)).append($('<div class="tw-tr"></div>').append($('<div class="tw-value-wrapper tw-td"></div>').append(r).append(l))).append($('<div class="tw-tr"></div>').append(o)),$(e).append(a),d()},this.onSettingsChanged=function(e){t=e;var n=!_.isUndefined(e.title)&&""!=e.title,a=!_.isUndefined(e.units)&&""!=e.units;e.sparkline?o.attr("style",null):(delete o.data().values,o.empty(),o.hide()),n?(i.html(_.isUndefined(e.title)?"":e.title),i.attr("style",null)):(i.empty(),i.hide()),a?(l.html(_.isUndefined(e.units)?"":e.units),l.attr("style",null)):(l.empty(),l.hide());var s=30;"big"==e.size&&(s=75,e.sparkline&&(s=60)),r.css({"font-size":s+"px"}),d()},this.onSizeChanged=function(){d()},this.onCalculatedValueChanged=function(e,a){"value"==e&&(t.animate?function(e,t,n){var a=$(t).text();if(a!=e)if($.isNumeric(e)&&$.isNumeric(a)){var i=e.toString().split("."),r=0;i.length>1&&(r=i[1].length);var l=0;(i=a.toString().split(".")).length>1&&(l=i[1].length),jQuery({transitionValue:Number(a),precisionValue:l}).animate({transitionValue:Number(e),precisionValue:r},{duration:n,step:function(){$(t).text(this.transitionValue.toFixed(this.precisionValue))},done:function(){$(t).text(e)}})}else $(t).text(e)}(a,r,500):r.text(a),t.sparkline&&n(o,a))},this.onDispose=function(){},this.getHeight=function(){return"big"==t.size||t.sparkline?2:1},this.onSettingsChanged(e)};freeboard.loadWidgetPlugin({type_name:"text_widget",display_name:"Text",settings:[{name:"title",display_name:"Title",type:"text"},{name:"size",display_name:"Size",type:"option",options:[{name:"Regular",value:"regular"},{name:"Big",value:"big"}]},{name:"value",display_name:"Value",type:"calculated"},{name:"sparkline",display_name:"Include Sparkline",type:"boolean"},{name:"animate",display_name:"Animate Value Changes",type:"boolean",default_value:!0},{name:"units",display_name:"Units",type:"text",options:function(){return{lbs:"",kgs:"",psi:"",meters:"",feet:"",mm:"",degC:"",degF:""}}}],newInstance:function(e,t){t(new i(e))}});var r=0;freeboard.addStyle(".gauge-widget-wrapper","width: 100%;text-align: center;"),freeboard.addStyle(".gauge-widget","width:200px;height:160px;display:inline-block;");freeboard.loadWidgetPlugin({type_name:"gauge",display_name:"Gauge",settings:[{name:"title",display_name:"Title",type:"text"},{name:"value",display_name:"Value",type:"calculated"},{name:"units",display_name:"Units",type:"text"},{name:"min_value",display_name:"Minimum",type:"text",default_value:0},{name:"max_value",display_name:"Maximum",type:"text",default_value:100}],newInstance:function(e,t){t(new function(e){var t,n="gauge-"+r++,a=$('<h2 class="section-title"></h2>'),i=$('<div class="gauge-widget" id="'+n+'"></div>'),l=!1,o=e;function d(){l&&(i.empty(),t=new JustGage({id:n,value:_.isUndefined(o.min_value)?0:o.min_value,min:_.isUndefined(o.min_value)?0:o.min_value,max:_.isUndefined(o.max_value)?0:o.max_value,label:o.units,showInnerShadow:!1,valueFontColor:"#d3d4d4"}))}this.render=function(e){l=!0,$(e).append(a).append($('<div class="gauge-widget-wrapper"></div>').append(i)),d()},this.onSettingsChanged=function(e){e.min_value!=o.min_value||e.max_value!=o.max_value||e.units!=o.units?(o=e,d()):o=e,a.html(e.title)},this.onCalculatedValueChanged=function(e,n){_.isUndefined(t)||("object"==typeof n&&(n=n[0]),t.refresh(Number(n)))},this.onDispose=function(){},this.getHeight=function(){return 3},this.onSettingsChanged(e)}(e))}}),freeboard.addStyle(".sparkline","width:100%;height: 75px;");var l=function(e){var a=$('<h2 class="section-title"></h2>'),i=$('<div class="sparkline"></div>'),r=$("<div></div>"),l=e;this.render=function(e){$(e).append(a).append(i).append(r)},this.onSettingsChanged=function(e){l=e,a.html(_.isUndefined(e.title)?"":e.title),e.include_legend&&function(e,n){for(var a=$("<div class='sparkline-legend'></div>"),i=0;i<n.length;i++){var r=t[i%t.length],l=n[i];a.append("<div class='sparkline-legend-value'><span style='color:"+r+"'>&#9679;</span>"+l+"</div>")}e.empty().append(a),freeboard.addStyle(".sparkline-legend","margin:5px;"),freeboard.addStyle(".sparkline-legend-value","color:white; font:10px arial,san serif; float:left; overflow:hidden; width:50%;"),freeboard.addStyle(".sparkline-legend-value span","font-weight:bold; padding-right:5px;")}(r,e.legend.split(","))},this.onCalculatedValueChanged=function(e,t){l.legend?n(i,t,l.legend.split(",")):n(i,t)},this.onDispose=function(){},this.getHeight=function(){var e=0;if(l.include_legend&&l.legend){var t=l.legend.split(",").length;t>4?e=.5*Math.floor((t-1)/4):t&&(e=.5)}return 2+e},this.onSettingsChanged(e)};freeboard.loadWidgetPlugin({type_name:"sparkline",display_name:"Sparkline",settings:[{name:"title",display_name:"Title",type:"text"},{name:"value",display_name:"Value",type:"calculated",multi_input:"true"},{name:"include_legend",display_name:"Include Legend",type:"boolean"},{name:"legend",display_name:"Legend",type:"text",description:"Comma-separated for multiple sparklines"}],newInstance:function(e,t){t(new l(e))}}),freeboard.addStyle("div.pointer-value","position:absolute;height:95px;margin: auto;top: 0px;bottom: 0px;width: 100%;text-align:center;");freeboard.loadWidgetPlugin({type_name:"pointer",display_name:"Pointer",settings:[{name:"direction",display_name:"Direction",type:"calculated",description:"In degrees"},{name:"value_text",display_name:"Value Text",type:"calculated"},{name:"units",display_name:"Units",type:"text"}],newInstance:function(e,t){t(new function(e){var t,n,a,i,r=$('<div class="widget-big-text"></div>'),l=$("<div></div>");this.render=function(e){a=$(e).width(),i=$(e).height();var o=Math.min(a,i)/2-6,d=(t=Raphael($(e).get()[0],a,i)).circle(a/2,i/2,o);d.attr("stroke","#FF9900"),d.attr("stroke-width",3),(n=t.path(function(e){if(!e||e.length<2)return[];var t=[];t.push(["m",e[0],e[1]]);for(var n=2;n<e.length;n+=2)t.push(["l",e[n],e[n+1]]);return t.push(["z"]),t}([a/2,i/2-o+3,15,20,-30,0]))).attr("stroke-width",0),n.attr("fill","#fff"),$(e).append($('<div class="pointer-value"></div>').append(r).append(l))},this.onSettingsChanged=function(e){l.html(e.units)},this.onCalculatedValueChanged=function(e,t){"direction"==e?_.isUndefined(n)||n.animate({transform:"r"+t+","+a/2+","+i/2},250,"bounce"):"value_text"==e&&r.html(t)},this.onDispose=function(){},this.getHeight=function(){return 4},this.onSettingsChanged(e)}(e))}});freeboard.loadWidgetPlugin({type_name:"picture",display_name:"Picture",fill_size:!0,settings:[{name:"src",display_name:"Image URL",type:"calculated"},{type:"number",display_name:"Refresh every",name:"refresh",suffix:"seconds",description:"Leave blank if the image doesn't need to be refreshed"}],newInstance:function(e,t){t(new function(e){var t,n,a;function i(){n&&(clearInterval(n),n=null)}function r(){if(t&&a){var e=a;$(t).css({"background-image":"url("+e+")"})}}this.render=function(e){$(e).css({width:"100%",height:"100%","background-size":"cover","background-position":"center"}),t=e},this.onSettingsChanged=function(e){i(),e.refresh&&e.refresh>0&&(n=setInterval(r,1e3*Number(e.refresh)))},this.onCalculatedValueChanged=function(e,t){"src"==e&&(a=t),r()},this.onDispose=function(){i()},this.getHeight=function(){return 4},this.onSettingsChanged(e)}(e))}}),freeboard.addStyle(".indicator-light","border-radius:50%;width:22px;height:22px;border:2px solid #3d3d3d;margin-top:5px;float:left;background-color:#222;margin-right:10px;"),freeboard.addStyle(".indicator-light.on","background-color:#FFC773;box-shadow: 0px 0px 15px #FF9900;border-color:#FDF1DF;"),freeboard.addStyle(".indicator-text","margin-top:10px;");freeboard.loadWidgetPlugin({type_name:"indicator",display_name:"Indicator Light",settings:[{name:"title",display_name:"Title",type:"text"},{name:"value",display_name:"Value",type:"calculated"},{name:"on_text",display_name:"On Text",type:"calculated"},{name:"off_text",display_name:"Off Text",type:"calculated"}],newInstance:function(e,t){t(new function(e){var t,n,a=$('<h2 class="section-title"></h2>'),i=$('<div class="indicator-text"></div>'),r=$('<div class="indicator-light"></div>'),l=e,o=!1;function d(){r.toggleClass("on",o),o?i.text(_.isUndefined(t)?_.isUndefined(l.on_text)?"":l.on_text:t):i.text(_.isUndefined(n)?_.isUndefined(l.off_text)?"":l.off_text:n)}this.render=function(e){$(e).append(a).append(r).append(i)},this.onSettingsChanged=function(e){l=e,a.html(_.isUndefined(e.title)?"":e.title),d()},this.onCalculatedValueChanged=function(e,a){"value"==e&&(o=Boolean(a)),"on_text"==e&&(t=a),"off_text"==e&&(n=a),d()},this.onDispose=function(){},this.getHeight=function(){return 1},this.onSettingsChanged(e)}(e))}}),freeboard.addStyle(".gm-style-cc a","text-shadow:none;"),freeboard.addStyle(".html-widget","white-space:normal;width:100%;height:100%");freeboard.loadWidgetPlugin({type_name:"html",display_name:"Show computed HTML",fill_size:!0,settings:[{name:"html",display_name:"HTML",type:"calculated",description:"Can be literal HTML, or javascript that outputs HTML."},{name:"height",display_name:"Height Blocks",type:"number",default_value:4,description:"A height block is around 60 pixels"}],newInstance:function(e,t){t(new function(e){var t=$('<div class="html-widget"></div>'),n=e;this.render=function(e){$(e).append(t)},this.onSettingsChanged=function(e){n=e},this.onCalculatedValueChanged=function(e,n){"html"==e&&t.html(n)},this.onDispose=function(){},this.getHeight=function(){return Number(n.height)},this.onSettingsChanged(e)}(e))}})}(),function(){freeboard.loadDatasourcePlugin({type_name:"core_scratchpad_plugin",display_name:"Scratchpad Variables",description:"The data is just an empty space.  To set some data, use datasources['scratchpad']['SomeName'] as a data target.  It will be available to read in other widgets.  You can also set the default data using JSON.",settings:[{name:"data",display_name:"Default Data(as JSON or JS expression)",type:"text",default_value:"={}",options:function(){return{"={key: 'value'}":""}},description:"Must be a valid JS =expression that returns an object. Whatever it returns will be the default data.",required:!0}],newInstance:function(t,n,a){n(new e(t,a))}});var e=function(e,t){var n=this;n.handler={set:function(e,a,i){e[a]=i,t(n.proxy)}},n.data=freeboard.eval(e.data),n.proxy=new Proxy(n.data,n.handler),n.onSettingsChanged=function(e){e,n.data=freeboard.eval(e.data),t(n.proxy)},n.updateNow=function(){var e;e=n.proxy,t(e)},n.onDispose=function(){}}}(),function(){var e=0;freeboard.addStyle(".slider","border: 2px solid #3d3d3d;background-color: #222;margin: 10px;"),freeboard.addStyle(".slider-label","margin-left: 10px; margin-top: 10px; text-transform: capitalize;"),freeboard.addStyle(".myui-slider-handle","width: 1.5em !important; height: 1.5em !important; border-radius: 50%; top: -.4em !important; margin-left:-1.0em !important;"),freeboard.addStyle(".ui-slider-range","background: #F90;"),freeboard.loadWidgetPlugin({type_name:"slider_plugin",display_name:"Slider",description:"Interactive Slider Plugin with 2-way data binding.  Value is a list of 2 items, the value and the timestamp.",fill_size:!0,settings:[{name:"title",display_name:"Title",type:"text"},{name:"unit",display_name:"Unit of measure",type:"text"},{name:"min",display_name:"Min",type:"calculated",default_value:"0"},{name:"max",display_name:"Max",type:"calculated",default_value:"100"},{name:"step",display_name:"Step",type:"calculated",default_value:"1"},{name:"mode",display_name:"Mode",type:"option",options:[{name:"Real Time",value:"input"},{name:"When Released",value:"change"}]},{name:"target",display_name:"Data target when value changes. ",description:"Value pushed will be a value, timestamp pair.",type:"target"}],newInstance:function(e,n){n(new t(e))}});var t=function(t){var n=this;currentSettings=t,currentSettings.unit=currentSettings.unit||"";var a="slider-"+e++,i=$('<div class="slider-widget slider-label" id="__'+a+'"></div>'),r=$('<h2 class="section-title slider-label"></h2>'),l=$('<div id="value-'+a+'" style="display:inline-block; padding-left: 10px; font-weight:bold; color: #d3d4d4" ></div>'),o=$("<input/>",{type:"range",id:a}),d="#"+a,s="#value-"+a;_.isUndefined(currentSettings.value)||currentSettings.value;r.html(_.isUndefined(currentSettings.title)?"":currentSettings.title),n.min=_.isUndefined(currentSettings.min)?0:currentSettings.min,n.max=_.isUndefined(currentSettings.max)?100:currentSettings.max,n.step=_.isUndefined(currentSettings.step)?100:currentSettings.step,n.value=currentSettings.value||0;n.render=function(e){$(e).append(i),r.appendTo(i),$(r).append(l),o.appendTo(i),$(d).attr("min",n.min),$(d).attr("max",n.max),$(d).attr("step",n.step),$(d).css("width","95%"),$(d).on("input",function(e){$("#value-"+a).html(e.value)}),$(s).html(n.value+currentSettings.unit),$(d).on("change",function(e){_.isUndefined(currentSettings.target)||n.dataTargets.target([e.target.value,Date.now()/1e3])}),$(d).on("input",function(e){n.value=e.target.value,$(s).html(e.target.value+currentSettings.unit),"change"!=currentSettings.mode&&(_.isUndefined(currentSettings.target)||n.dataTargets.target([parseFloat(e.target.value),Date.now()/1e3]))}),$(d).removeClass("ui-widget-content")},n.getHeight=function(){return"big"==currentSettings.size?2:1},n.onSettingsChanged=function(e){currentSettings=e,r.html(_.isUndefined(e.title)?"":e.title),$(r).append(l),currentSettings.unit=currentSettings.unit||"",$(s).html(n.value+currentSettings.unit)},n.onCalculatedValueChanged=function(e,t){if("target"==e){n.value=t;var a=t;"object"==typeof a&&(a=a[0]),$(l).html(a+currentSettings.unit),a!=$(d).val()&&$(d).val(a)}"step"==e&&(n.step=t,$(d).attr("step",n.step)),"max"==e&&(t>n.min?(n.max=t,$(d).attr("max",t)):(currentSettings.max=n.max,freeboard.showDialog($("<div align='center'> Max value cannot be lower than Min value!</div>"),"Warning!","OK",null,function(){}))),"min"==e&&(t<n.max?(n.min=t,$(d).attr("min",t)):(currentSettings.min=n.min,freeboard.showDialog($("<div align='center'> Min value cannot be greater than Max value!</div>"),"Warning!","OK",null,function(){})))},n.onDispose=function(){}}}(),function(){var e=0;freeboard.loadWidgetPlugin({type_name:"switch_plugin",display_name:"Switch",description:"Interactive on-off switch",settings:[{name:"title",display_name:"Title",type:"text"},{name:"target",display_name:"Data Target",type:"target",description:"Bind state to this datasource"},{name:"on_text",display_name:"On Text",type:"text",default_value:"On"},{name:"off_text",display_name:"Off Text",type:"text",default_value:"Off"}],newInstance:function(e,n){n(new t(e))}}),freeboard.addStyle(".floating-box","display: inline-block; vertical-align: top; width: 78px; background-color: #222;margin-top: 10px; margin-right: 5px;"),freeboard.addStyle(".onoffswitch-title","font-size: 17px; line-height: 29px; width: 65%; height: 29px; padding-left: 10px;border: 1px solid #3d3d3d;"),freeboard.addStyle(".round","border-radius: 50%;");var t=function(t){var n=this,a="onoffswitch-"+e++,i=t,r=$('<div class="floating-box"></div>'),l=$('<div class="floating-box onoffswitch-title">'+t.title+"</div>"),o=$('<div class="onoffswitch"><label class="onoffswitch-label" for="'+a+'"><div class="onoffswitch-inner"><span class="on"></span><span class="off"></span></div><div class="onoffswitch-switch round"></div></label></div>');function d(){$("#"+a).prop("checked",n.isOn),console.log(o.find("span.on")),o.find("span.on").text(n.onText),o.find("span.off").text(n.offText)}o.prependTo(r),n.isOn=!1,this.render=function(e){$(e).append(r).append(l);$('<input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="'+a+'">').prependTo(o).change(function(e){n.isOn=e.target.checked,_.isUndefined(i.target)||n.dataTargets.target([n.isOn,Date.now()/1e3])})},this.onSettingsChanged=function(e){i=e,l.html(_.isUndefined(e.title)?"":e.title),console.log("isUndefined on_text: "+_.isUndefined(e.on_text)),n.onText=e.on_text,n.offText=e.off_text,d()},this.onCalculatedValueChanged=function(e,t){if(console.log(e,t),"target"==e){var a=t;"object"==typeof a&&(a=a[0]),n.isOn=Boolean(a)}d()},this.onDispose=function(){},this.getHeight=function(){return 1},this.onSettingsChanged(t)}}(),function(){var e=0;freeboard.addStyle(".textbox","border: 2px solid #3d3d3d;background-color: #222;margin: 10px;"),freeboard.addStyle(".textbox-label","margin-left: 10px; margin-top: 10px; text-transform: capitalize;"),freeboard.addStyle(".myui-textbox-handle","width: 1.5em !important; height: 1.5em !important; border-radius: 50%; top: -.4em !important; margin-left:-1.0em !important;"),freeboard.addStyle(".ui-textbox-range","background: #F90;"),freeboard.loadWidgetPlugin({type_name:"textbox_plugin",display_name:"Text Box",description:"Interactive Textbox Plugin with 2-way data binding.  Value is a list of 2 items, the value and the timestamp.",fill_size:!0,settings:[{name:"title",display_name:"Title",type:"text",default_value:""},{name:"tooltip",display_name:"Tooltip hint",type:"text",default_value:""},{name:"pattern",display_name:"Validation Regex",type:"text",default_value:".*"},{name:"placeholder",display_name:"Placeholder text",type:"calculated",default_value:""},{name:"mode",display_name:"Mode",type:"option",options:[{name:"Real Time",value:"input"},{name:"When element loses focus",value:"change"}]},{name:"target",display_name:"Data target when value changes. ",description:"Value pushed will be a value, timestamp pair.",type:"target"}],newInstance:function(e,n){n(new t(e))}});var t=function(t){var n=this;n.currentSettings=t;var a="textbox-"+e++,i=$('<div class="textbox-widget textbox-label" id="__'+a+'"></div>'),r=$('<h2 class="section-title textbox-label"></h2>'),l=$("<input/>",{type:"text",pattern:t.pattern,id:a,name:a}).css("width","90%"),o="#"+a,d="#value-"+a;r.html(n.currentSettings.title),n.value=n.currentSettings.value||0;n.render=function(e){$(e).append(i),r.appendTo(i),l.appendTo(i),$(o).attr("placeholder",n.currentSettings.placeholder),$(o).attr("title",n.currentSettings.tooltip),$(o).attr("pattern",n.currentSettings.pattern),$(d).html(n.value+n.currentSettings.unit),$(o).on("change",function(e){_.isUndefined(n.currentSettings.target)||n.dataTargets.target([e.target.value,Date.now()/1e3])}),$(o).on("input",function(e){n.value=e.target.value,$(d).html(e.target.value+n.currentSettings.unit),"change"!=n.currentSettings.mode&&(_.isUndefined(n.currentSettings.target)||n.dataTargets.target([e.target.value,Date.now()/1e3]))}),$(o).removeClass("ui-widget-content")},n.getHeight=function(){return"big"==n.currentSettings.size?2:1},n.onSettingsChanged=function(e){n.currentSettings=e,r.html(_.isUndefined(e.title)?"":e.title),n.currentSettings.unit=n.currentSettings.unit||"",$(o).attr("pattern",e.pattern),$(o).attr("placeholder",e.placeholder),$(o).attr("tooltip",e.placeholder)},n.onCalculatedValueChanged=function(e,t){if("target"==e){n.value=t;var a=t;"object"==typeof a&&(a=a[0]),a!=$(o).val()&&$(o).val(a)}"placeholder"==e&&$(o).attr("placeholder",t)},n.onDispose=function(){}}}();